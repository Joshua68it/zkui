<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>Grails ZK UI Plugin 0.4 - Reference Documentation</title>
        <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" title="Style" charset="utf-8"/>
        <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8" />
    </head>
    <body class="body">
        <div id="header">
            <div class="images"><br/><br/>
                <a href="http://grails.org" target="_blank"><img alt="ZK UI Logo" title="ZK UI Plugin for Grails Framework" src="../img/zkui_logo.png" border="0"/></a>
                <span style="right:30px; top:20px; position:absolute;">
                    <a href="../index.html" target="_top">Frames</a> | <a href="index.html" target="_top">No Frames</a><br/><br/>
                    <a href="http://springsource.com" target="_blank"></a>
                </span>
            </div>
            <div class="message">zkui</div>
            <h1>Grails ZK UI Plugin - Reference Documentation</h1>
            <p><strong>Authors:</strong> groovyquan</p>
            <p><strong>Version:</strong> 0.4</p>
            <em>This document is licensed under GNU Free Documentation License,ZK UI Plugin is released under LGPL</em>
        </div>

        <div id="toc">
            <h2>Table of Contents</h2>
            <div class="tocItem" style="margin-left:0px"><a href="#1. Introduction">1. Introduction</a></div><div class="tocItem" style="margin-left:10px"><a href="#1.1 Taglib">1.1 Taglib</a></div><div class="tocItem" style="margin-left:10px"><a href="#1.2 Composer">1.2 Composer</a></div><div class="tocItem" style="margin-left:10px"><a href="#1.3 Builder">1.3 Builder</a></div><div class="tocItem" style="margin-left:10px"><a href="#1.4 Selector">1.4 Selector</a></div><div class="tocItem" style="margin-left:0px"><a href="#2. Getting Started">2. Getting Started</a></div><div class="tocItem" style="margin-left:10px"><a href="#2.1 Hello World">2.1 Hello World</a></div><div class="tocItem" style="margin-left:10px"><a href="#2.2 Say Hello in Ajax way">2.2 Say Hello in Ajax way</a></div><div class="tocItem" style="margin-left:10px"><a href="#2.3 Identify a component">2.3 Identify a component</a></div><div class="tocItem" style="margin-left:10px"><a href="#2.4 A component is a POJO">2.4 A component is a POJO</a></div><div class="tocItem" style="margin-left:10px"><a href="#2.5 Separating code from user interface">2.5 Separating code from user interface</a></div><div class="tocItem" style="margin-left:0px"><a href="#3. Composer">3. Composer</a></div><div class="tocItem" style="margin-left:10px"><a href="#3.1 Creating a composer">3.1 Creating a composer</a></div><div class="tocItem" style="margin-left:10px"><a href="#3.2 Apply a composer">3.2 Apply a composer</a></div><div class="tocItem" style="margin-left:10px"><a href="#3.3 Auto-wired Component">3.3 Auto-wired Component</a></div><div class="tocItem" style="margin-left:10px"><a href="#3.4 Redirects">3.4 Redirects</a></div><div class="tocItem" style="margin-left:10px"><a href="#3.5 Data Binding">3.5 Data Binding</a></div><div class="tocItem" style="margin-left:10px"><a href="#3.6 Unit Test">3.6 Unit Test</a></div><div class="tocItem" style="margin-left:10px"><a href="#3.7 Render Errors">3.7 Render Errors</a></div><div class="tocItem" style="margin-left:10px"><a href="#3.8 ZK's Data Binding">3.8 ZK's Data Binding</a></div><div class="tocItem" style="margin-left:0px"><a href="#4. Builder">4. Builder</a></div><div class="tocItem" style="margin-left:10px"><a href="#4.1 appendChild">4.1 appendChild</a></div><div class="tocItem" style="margin-left:10px"><a href="#4.2 leftShift">4.2 leftShift</a></div><div class="tocItem" style="margin-left:10px"><a href="#4.3 Event listening">4.3 Event listening</a></div><div class="tocItem" style="margin-left:10px"><a href="#4.4 Client-side event listening">4.4 Client-side event listening</a></div><div class="tocItem" style="margin-left:0px"><a href="#5. Selector">5. Selector</a></div><div class="tocItem" style="margin-left:10px"><a href="#5.1 Selector overview">5.1 Selector overview</a></div><div class="tocItem" style="margin-left:10px"><a href="#5.2 Base Selector">5.2 Base Selector</a></div><div class="tocItem" style="margin-left:10px"><a href="#5.3 Selector combinations">5.3 Selector combinations</a></div><div class="tocItem" style="margin-left:10px"><a href="#5.4 Pseudo selectors">5.4 Pseudo selectors</a></div><div class="tocItem" style="margin-left:0px"><a href="#6. Event Handling">6. Event Handling</a></div><div class="tocItem" style="margin-left:10px"><a href="#6.1 Event Listening">6.1 Event Listening</a></div><div class="tocItem" style="margin-left:10px"><a href="#6.2 Client-side Event Listening">6.2 Client-side Event Listening</a></div><div class="tocItem" style="margin-left:0px"><a href="#7. Scaffolding Templates">7. Scaffolding Templates</a></div><div class="tocItem" style="margin-left:10px"><a href="#7.1 Static Scaffolding">7.1 Static Scaffolding</a></div><div class="tocItem" style="margin-left:10px"><a href="#7.2 Customizing the scaffolding templates">7.2 Customizing the scaffolding templates</a></div><div class="tocItem" style="margin-left:0px"><a href="#8. Integration">8. Integration</a></div><div class="tocItem" style="margin-left:10px"><a href="#8.1 ZK EE">8.1 ZK EE</a></div><div class="tocItem" style="margin-left:10px"><a href="#8.2 ZK Themes">8.2 ZK Themes</a></div><div class="tocItem" style="margin-left:10px"><a href="#8.3 ZK Extensions Component">8.3 ZK Extensions Component</a></div>
        </div>
        <div id="content">
            <h1><a name="1. Introduction">1. Introduction</a></h1>ZK UI plugin,the same as the ZKGrails plugin, seamlessly integrates ZK with Grails' infrastructures.<p class="paragraph"/>The difference is it uses the Grails' infrastructures more, such as gsp, controllers rather than zk's zul.<p class="paragraph"/>ZK UI Grails plug-ins brings powerful features as follows<p class="paragraph"/><p class="paragraph"/><h2><a name="1.1 Taglib">1.1 Taglib</a></h2>Use Tag Libraries
<div class="code"><pre><span class="xml&#45;tag">&#60;z:window title=<span class="xml&#45;quote">"My First ZK UI Application"</span> border=<span class="xml&#45;quote">"normal"</span>&#62;</span>
    Hello World!
<span class="xml&#45;tag">&#60;/z:window&#62;</span></pre></div>
<img border="0" class="center" src="../img/2.1 Hello World.png"></img><h2><a name="1.2 Composer">1.2 Composer</a></h2>Provides a Composer Artefacts simplify the integration between grails and zk<p class="paragraph"/>Usage:
<div class="code"><pre>grails create&#45;composer &#91;name&#93;</pre></div><h2><a name="1.3 Builder">1.3 Builder</a></h2>A groovy way to create zk components, following groovy Builder paradigm<p class="paragraph"/><code>Controller</code>
<div class="code"><pre>def index = &#123;
    def window = <span class="java&#45;keyword">new</span> Window(title: <span class="java&#45;quote">"listbox demo"</span>, border: <span class="java&#45;quote">"normal"</span>)
    window &#60;&#60; &#123;
        listbox &#123;
            listhead(sizable: <span class="java&#45;keyword">true</span>) &#123;
                listheader(label: <span class="java&#45;quote">"name"</span>, sort: <span class="java&#45;quote">"auto"</span>)
                listheader(label: <span class="java&#45;quote">"gender"</span>, sort: <span class="java&#45;quote">"auto"</span>)
            &#125;
            listitem &#123;
                listcell(label: <span class="java&#45;quote">"Mary"</span>)
                listcell(label: <span class="java&#45;quote">"FEMALE"</span>)
            &#125;
            listitem &#123;
                listcell(label: <span class="java&#45;quote">"John"</span>)
                listcell(label: <span class="java&#45;quote">"MALE"</span>)
            &#125;
            listitem &#123;
                listcell(label: <span class="java&#45;quote">"Jane"</span>)
                listcell(label: <span class="java&#45;quote">"FEMALE"</span>)
            &#125;
            listitem &#123;
                listcell(label: <span class="java&#45;quote">"Henry"</span>)
                listcell(label: <span class="java&#45;quote">"MALE"</span>)
            &#125;
            listfoot &#123;
                listfooter &#123;
                    label(value: <span class="java&#45;quote">"This is footer1"</span>)
                &#125;
                listfooter &#123;
                    label(value: <span class="java&#45;quote">"This is footer2"</span>)
                &#125;
            &#125;
        &#125;
    &#125;
    &#91;window:window&#93;
&#125;</pre></div><p class="paragraph"/><code>View</code>
<div class="code"><pre><span class="xml&#45;tag">&#60;z:render comp=<span class="xml&#45;quote">"$&#123;window&#125;"</span>/&#62;</span></pre></div>
<img border="0" class="center" src="../img/listbox.png"></img><h2><a name="1.4 Selector">1.4 Selector</a></h2>Provides a very convenient API for extracting and manipulating zk component, using the jquery-like methods.<p class="paragraph"/>View
<div class="code"><pre><span class="xml&#45;tag">&#60;z:window id=<span class="xml&#45;quote">"window"</span>&#62;</span>
    <span class="xml&#45;tag">&#60;z:textbox name=<span class="xml&#45;quote">"t1"</span> value=<span class="xml&#45;quote">"value1"</span>/&#62;</span>
    <span class="xml&#45;tag">&#60;z:textbox id=<span class="xml&#45;quote">"t2"</span> value=<span class="xml&#45;quote">"value2"</span>/&#62;</span>
    <span class="xml&#45;tag">&#60;z:textbox value=<span class="xml&#45;quote">"value3"</span>/&#62;</span>
<span class="xml&#45;tag">&#60;/z:window&#62;</span></pre></div><p class="paragraph"/>Selector code
<div class="code"><pre>assert 3 == window.select(<span class="java&#45;quote">"textbox"</span>).size()
assert <span class="java&#45;quote">"value2"</span> == window.select(<span class="java&#45;quote">"&#35;t2"</span>)&#91;0&#93;.value
assert <span class="java&#45;quote">"value1"</span> == window.select(<span class="java&#45;quote">"textbox&#91;name=t1&#93;"</span>)&#91;0&#93;.value</pre></div><h1><a name="2. Getting Started">2. Getting Started</a></h1>
<h2><a name="2.1 Hello World">2.1 Hello World</a></h2><h3>DOCTYPE</h3>
The html pages generated by gsp must generate the doc type as follows.
<div class="code"><pre>&#60;!DOCTYPE html PUBLIC <span class="xml&#45;quote">"&#45;//W3C//DTD XHTML 1.0 Transitional//EN"</span>
 <span class="xml&#45;quote">"http://www.w3.org/TR/xhtml1/DTD/xhtml1&#45;transitional.dtd"</span>&#62;</pre></div><p class="paragraph"/><h3>Importing resources</h3>
Add the tag &#60;z:resources/&#62; to the head of the layout/main.gsp or any page that you want to use ZK UI Grails plug-ins.
<div class="code"><pre><span class="xml&#45;tag">&#60;html xmlns=<span class="xml&#45;quote">"http://www.w3.org/1999/xhtml"</span>&#62;</span>
  <span class="xml&#45;tag">&#60;head&#62;</span>
  <span class="xml&#45;tag">&#60;z:resources/&#62;</span></pre></div><p class="paragraph"/><h3>Hello World!</h3>
<div class="code"><pre>&#60;!DOCTYPE html PUBLIC <span class="xml&#45;quote">"&#45;//W3C//DTD XHTML 1.0 Transitional//EN"</span>
 <span class="xml&#45;quote">"http://www.w3.org/TR/xhtml1/DTD/xhtml1&#45;transitional.dtd"</span>&#62;
<span class="xml&#45;tag">&#60;html xmlns=<span class="xml&#45;quote">"http://www.w3.org/1999/xhtml"</span>&#62;</span>
<span class="xml&#45;tag">&#60;head&#62;</span>
    <span class="xml&#45;tag">&#60;title&#62;</span>Hello World Demo<span class="xml&#45;tag">&#60;/title&#62;</span>
    <span class="xml&#45;tag">&#60;z:resources/&#62;</span>
<span class="xml&#45;tag">&#60;/head&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;body&#62;</span>
<span class="xml&#45;tag">&#60;z:window title=<span class="xml&#45;quote">"My First ZK UI Application"</span> border=<span class="xml&#45;quote">"normal"</span>&#62;</span>
    Hello World!
<span class="xml&#45;tag">&#60;/z:window&#62;</span>
<span class="xml&#45;tag">&#60;/body&#62;</span>
<span class="xml&#45;tag">&#60;/html&#62;</span></pre></div><p class="paragraph"/><img border="0" class="center" src="../img/2.1 Hello World.png"></img><h2><a name="2.2 Say Hello in Ajax way">2.2 Say Hello in Ajax way</a></h2>Let us put some interactivity into it.
<div class="code"><pre><span class="xml&#45;tag">&#60;z:button label=<span class="xml&#45;quote">"Say Hello"</span> onClick=<span class="xml&#45;quote">"Messagebox.show('Hello World! Time now is:'+new Date())"</span>/&#62;</span></pre></div>
Then, when you click the button, you'll see the following:<p class="paragraph"/><img border="0" class="center" src="../img/2.2 Say Hello in Ajax way.png"></img><p class="paragraph"/>The onClick attribute is a special attribute used to add an event listener to the component such that it is invoked when an end user clicks the component. The attribute value could be any legal groovy code.<p class="paragraph"/>Here we invoke <a href="http://www.zkoss.org/javadoc/latest/zk/org/zkoss/zul/Messagebox.html#show(java.lang.String)" target="blank">Messagebox.show(String)</a> to show a message box as depicted above.<p class="paragraph"/><blockquote class="note">
Notice that it is not JavaScript,It is Groovy and runs at the server
</blockquote><h2><a name="2.3 Identify a component">2.3 Identify a component</a></h2>A component is a POJO, so you can reference it any way you like. However, ZK provides a convenient way to identify and to retrieve a component: identifier. For example, we named the textbox as input by assigning id to it, as follows.<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;z:window title=<span class="xml&#45;quote">"Property Retrieval"</span> border=<span class="xml&#45;quote">"normal"</span>&#62;</span>
    Enter a property name: <span class="xml&#45;tag">&#60;z:textbox id=<span class="xml&#45;quote">"input"</span>/&#62;</span>
    <span class="xml&#45;tag">&#60;z:button label=<span class="xml&#45;quote">"Retrieve"</span> onClick=<span class="xml&#45;quote">"Messagebox.show(System.getProperty(input.getValue()))"</span>/&#62;</span>
<span class="xml&#45;tag">&#60;/z:window&#62;</span></pre></div><p class="paragraph"/><img border="0" class="center" src="../img/2.3 Identify a component.png"></img><h2><a name="2.4 A component is a POJO">2.4 A component is a POJO</a></h2>A component is a POJO. You could instantiate and manipulate directly. For example, we could generate the result by instantiating a component to represent it, and then append it to another component (an instance of <a href="http://books.zkoss.org/wiki/ZK_Component_Reference/Layouts/Vlayout" target="blank">vlayout</a>).<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;z:window title=<span class="xml&#45;quote">"Property Retrieval"</span> border=<span class="xml&#45;quote">"normal"</span>&#62;</span>
    Enter a property name: <span class="xml&#45;tag">&#60;z:textbox id=<span class="xml&#45;quote">"input"</span>/&#62;</span>
    <span class="xml&#45;tag">&#60;z:button label=<span class="xml&#45;quote">"Retrieve"</span> onClick=<span class="xml&#45;quote">"result.appendChild(new Label(System.getProperty(input.getValue())))"</span>/&#62;</span>
    <span class="xml&#45;tag">&#60;z:vlayout id=<span class="xml&#45;quote">"result"</span>/&#62;</span>
<span class="xml&#45;tag">&#60;/z:window&#62;</span></pre></div><p class="paragraph"/>Similarly you could change the state of a component directly. All modifications will be synchronized back to the client automatically.<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;z:window title=<span class="xml&#45;quote">"Property Retrieval"</span> border=<span class="xml&#45;quote">"normal"</span>&#62;</span>
    Enter a property name: <span class="xml&#45;tag">&#60;z:textbox id=<span class="xml&#45;quote">"input"</span>/&#62;</span>
    <span class="xml&#45;tag">&#60;z:button label=<span class="xml&#45;quote">"Retrieve"</span> onClick=<span class="xml&#45;quote">"result.setValue(System.getProperty(input.getValue()))"</span>/&#62;</span>
    <span class="xml&#45;tag">&#60;z:separator/&#62;</span>
    <span class="xml&#45;tag">&#60;z:label id=<span class="xml&#45;quote">"result"</span>/&#62;</span>
<span class="xml&#45;tag">&#60;/z:window&#62;</span></pre></div><h2><a name="2.5 Separating code from user interface">2.5 Separating code from user interface</a></h2>Embedding Groovy code in a gsp page is straightforward and easy to read. However, in a production environment, it is usually better to separate the code from the user interfaces. In additions, the compiled Groovy code runs much faster than the embedded code which is interpreted at the run time.<p class="paragraph"/>To separate code from UI, we could implement a Composer<p class="paragraph"/>use create-composer command<p class="paragraph"/><div class="code"><pre>grails create&#45;composer zkuidemo.PropertyRetriever</pre></div><p class="paragraph"/>A composer called PropertyRetrieverComposer will be created in the grails-app/composers directory<p class="paragraph"/>Modify the generated PropertyRetrieverComposer as follows<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">package</span> zkuidemo<p class="paragraph"/><span class="java&#45;keyword">import</span> org.zkoss.zk.ui.Component
<span class="java&#45;keyword">import</span> org.zkoss.zk.ui.event.Event
<span class="java&#45;keyword">import</span> org.zkoss.zul.Label<p class="paragraph"/>class PropertyRetrieverComposer &#123;<p class="paragraph"/>    def afterCompose = &#123;Component target &#45;&#62;
        target.addEventListener(<span class="java&#45;quote">"onClick"</span>, <span class="java&#45;keyword">new</span> org.zkoss.zk.ui.event.EventListener() &#123; //add a event listener in Groovy
            <span class="java&#45;keyword">public</span> void onEvent(Event event) &#123;
                <span class="java&#45;object">String</span> prop = <span class="java&#45;object">System</span>.getProperty(target.getFellow(<span class="java&#45;quote">"input"</span>).getValue())
                target.getFellow(<span class="java&#45;quote">"result"</span>).appendChild(<span class="java&#45;keyword">new</span> Label(prop))
            &#125;
        &#125;);
    &#125;
&#125;</pre></div><p class="paragraph"/>
The above code can be simplified as follows<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">package</span> zkuidemo<p class="paragraph"/><span class="java&#45;keyword">import</span> org.zkoss.zk.ui.Component
<span class="java&#45;keyword">import</span> org.zkoss.zk.ui.event.Event
<span class="java&#45;keyword">import</span> org.zkoss.zul.Label<p class="paragraph"/>class PropertyRetrieverComposer &#123;<p class="paragraph"/>    def afterCompose = &#123;Component target &#45;&#62;
        target.addEventListener(<span class="java&#45;quote">"onClick"</span>) &#123;Event event &#45;&#62;
            <span class="java&#45;object">String</span> prop = <span class="java&#45;object">System</span>.getProperty(target.getFellow(<span class="java&#45;quote">"input"</span>).value)
            target.getFellow(<span class="java&#45;quote">"result"</span>).appendChild(<span class="java&#45;keyword">new</span> Label(prop))
        &#125;
    &#125;
&#125;</pre></div><p class="paragraph"/>Then, we could associate the Composer (zkuidemo.PropertyRetrieverComposer) with a component by use of the apply attribute as shown below.
<div class="code"><pre><span class="xml&#45;tag">&#60;z:window title=<span class="xml&#45;quote">"Property Retrieval"</span> border=<span class="xml&#45;quote">"normal"</span>&#62;</span>
    Enter a property name: <span class="xml&#45;tag">&#60;z:textbox id=<span class="xml&#45;quote">"input"</span>/&#62;</span>
    <span class="xml&#45;tag">&#60;z:button label=<span class="xml&#45;quote">"Retrieve"</span> apply=<span class="xml&#45;quote">"zkuidemo.PropertyRetrieverComposer"</span>/&#62;</span>
    <span class="xml&#45;tag">&#60;z:separator/&#62;</span>
    <span class="xml&#45;tag">&#60;z:vlayout id=<span class="xml&#45;quote">"result"</span>/&#62;</span>
<span class="xml&#45;tag">&#60;/z:window&#62;</span></pre></div>
<h1><a name="3. Composer">3. Composer</a></h1>A composer is responsible to initialize a component (or a component of tree) when ZK loader is composing a component. It is the controller in the MVC pattern, while the component is the view,which separate the code from the user interfaces.
<h2><a name="3.1 Creating a composer">3.1 Creating a composer</a></h2>Composers can be created with the create-composer target. For example try running the following command from the root of a Grails project:
<div class="code"><pre>grails create&#45;composer window</pre></div><p class="paragraph"/>The command will result in the creation of a composer at the location grails-app/composers/WindowComposer.groovy:
<div class="code"><pre>class WindowComposer &#123;
    def afterCompose = &#123;Component comp &#45;&#62;
        // initialize components here
    &#125;
&#125;</pre></div>
WindowComposer by default provide a <code>afterCompose</code> closure to initialize components.<p class="paragraph"/><blockquote class="note">
The create-composer command is merely for convenience and you can just as easily create composers using your favorite text editor or IDE
</blockquote><h2><a name="3.2 Apply a composer">3.2 Apply a composer</a></h2>Each component Taglib has a <code>apply</code> attribute,so you can place the composer here
<div class="code"><pre><span class="xml&#45;tag">&#60;z:window id=<span class="xml&#45;quote">"myWindowComposer"</span> apply=<span class="xml&#45;quote">"package.WindowComposer"</span>&#62;</span>
    &#8230;
<span class="xml&#45;tag">&#60;/z:window&#62;</span></pre></div><p class="paragraph"/>In the WindowComposer side
<div class="code"><pre>def afterCompose = &#123;Component comp &#45;&#62;
    assert comp.id==<span class="java&#45;quote">"myWindowComposer"</span>
    assert (comp <span class="java&#45;keyword">instanceof</span> org.zkoss.zul.Window)
&#125;</pre></div><h2><a name="3.3 Auto-wired Component">3.3 Auto-wired Component</a></h2>If apply a <code>composer</code> to a Component that implement a <code>IdSpace</code> Interface,such as org.zkoss.zul.Window. The Component's children can be auto-wired to composer's fields<p class="paragraph"/>The following is an example. The onChange event received by Textbox <code>mytextbox</code> will be forwarded to target Window <code>mywin</code> as a new target event onChange_mytextbox and the Textbox component with id name "mytextbox" and Label with id name <code>mylabel</code> are injected into the "mytextbox" and "mylabel" fields respectively(so you can use mytextbox and mylabel variable directly in onChange_mytextbox without problem).<p class="paragraph"/>Composer
<div class="code"><pre>class MyComposer&#123;
    Textbox mytextbox
    Window self //embeded object, the supervised window <span class="java&#45;quote">"mywin"</span>
    Page page //the ZK page
    Label mylabel<p class="paragraph"/>    def afterCompose = &#123;Component comp &#45;&#62;
        assert mytextbox.id==<span class="java&#45;quote">"mytextbox"</span>
        assert mylabel.id==<span class="java&#45;quote">"mylabel"</span>
    &#125;<p class="paragraph"/>    def onChange_mytextbox(Event event) &#123;
        mylabel.setValue(<span class="java&#45;quote">"You just entered: "</span>+ mytextbox.getValue())
    &#125;
&#125;</pre></div><p class="paragraph"/>View
<div class="code"><pre><span class="xml&#45;tag">&#60;z:window id=<span class="xml&#45;quote">"mywin"</span> apply=<span class="xml&#45;quote">"MyComposer"</span>&#62;</span>
    <span class="xml&#45;tag">&#60;z:textbox id=<span class="xml&#45;quote">"mytextbox"</span>/&#62;</span>
    <span class="xml&#45;tag">&#60;z:label id=<span class="xml&#45;quote">"mylabel"</span>/&#62;</span>
<span class="xml&#45;tag">&#60;/z:window&#62;</span></pre></div><h2><a name="3.4 Redirects">3.4 Redirects</a></h2>
Actions can be redirected using the redirect method present in all composers<p class="paragraph"/>The parameters of <code>redirect</code> is same as controller's <code>redirect</code><p class="paragraph"/>Composer
<div class="code"><pre>class MyComposer&#123;
    Button mybutton<p class="paragraph"/>    def afterCompose = &#123;Component comp &#45;&#62;<p class="paragraph"/>    &#125;<p class="paragraph"/>    def onClick_mybutton(Event event) &#123;
        redirect(controller: 'demo', action: 'index', id: 1)
    &#125;
&#125;</pre></div><p class="paragraph"/><blockquote class="note">
following code same as <code>onClick_button</code> above<p class="paragraph"/><div class="code"><pre>def afterCompose = &#123;Component comp &#45;&#62;
    mybutton.addEventListener('onClick')&#123;
        redirect(controller: 'demo', action: 'index', id: 1)
    &#125;
&#125;</pre></div><p class="paragraph"/></blockquote><p class="paragraph"/>
View
<div class="code"><pre><span class="xml&#45;tag">&#60;z:window id=<span class="xml&#45;quote">"mywin"</span> apply=<span class="xml&#45;quote">"MyComposer"</span>&#62;</span>
    <span class="xml&#45;tag">&#60;z:button label=<span class="xml&#45;quote">"mybutton"</span>/&#62;</span>
<span class="xml&#45;tag">&#60;/z:window&#62;</span></pre></div><p class="paragraph"/><h2><a name="3.5 Data Binding">3.5 Data Binding</a></h2>
To uses Grails' underlying data binding capability,<code>zkui</code> injection a <code>getParams</code> method to <a href="http://www.zkoss.org/javadoc/latest/zk/org/zkoss/zk/ui/Component.html" target="blank">Component</a>.<p class="paragraph"/>Domain Class
<div class="code"><pre>class Person &#123;
    <span class="java&#45;object">String</span> firstName
    <span class="java&#45;object">String</span> lastName
    <span class="java&#45;object">String</span> fullName
    <span class="java&#45;keyword">static</span> constraints = &#123;
    &#125;
&#125;</pre></div><p class="paragraph"/>View
<div class="code"><pre><span class="xml&#45;tag">&#60;z:window id=<span class="xml&#45;quote">"mywin"</span> apply=<span class="xml&#45;quote">"MyComposer"</span>&#62;</span>
    <span class="xml&#45;tag">&#60;z:textbox name=<span class="xml&#45;quote">"firstName"</span>/&#62;</span>
    <span class="xml&#45;tag">&#60;z:textbox name=<span class="xml&#45;quote">"lastName"</span>/&#62;</span>
    <span class="xml&#45;tag">&#60;z:textbox name=<span class="xml&#45;quote">"fullName"</span>/&#62;</span>
    <span class="xml&#45;tag">&#60;z:button label=<span class="xml&#45;quote">"submit"</span>/&#62;</span>
<span class="xml&#45;tag">&#60;/z:window&#62;</span></pre></div><p class="paragraph"/>Composer
<div class="code"><pre>class MyComposer&#123;
    Button submit
    def afterCompose = &#123;Component mywin &#45;&#62;
        submit.addEventListener('onClick')&#123;
            def person=<span class="java&#45;keyword">new</span> Person(mywin.params)
            &#8230;
        &#125;
    &#125;
&#125;</pre></div><p class="paragraph"/>A <code>bindData</code> method same as in <code>controller</code> also provide to Composer<p class="paragraph"/><div class="code"><pre>def p = <span class="java&#45;keyword">new</span> Person()
bindData(p, mywin.params)</pre></div>
<h2><a name="3.6 Unit Test">3.6 Unit Test</a></h2>When use <strong class="bold">grails create-composer</strong> create a composer,a unit class that is a sub-class of ComposerUnitTestCase also created<p class="paragraph"/>It provides a <code>mockComposer</code> methods for mocking zkui's  Selector,Builder and so on.<p class="paragraph"/><div class="code"><pre>mockComposer(MyComposer)
def myComposer=<span class="java&#45;keyword">new</span> MyComposer
...</pre></div>
<h2><a name="3.7 Render Errors">3.7 Render Errors</a></h2><code>zkui</code> injection a <code>renderErrors</code> method to <a href="http://www.zkoss.org/javadoc/latest/zk/org/zkoss/zk/ui/Component.html" target="blank">Component</a>.<p class="paragraph"/>If you have Domain class
<div class="code"><pre>class Book&#123;
    <span class="java&#45;object">String</span> author
    <span class="java&#45;object">String</span> title
&#125;</pre></div><p class="paragraph"/>In View
<div class="code"><pre><span class="xml&#45;tag">&#60;z:window id=<span class="xml&#45;quote">"formWindow"</span> title=<span class="xml&#45;quote">"demo"</span> apply=<span class="xml&#45;quote">"your.Composer"</span>&#62;</span>
    <span class="xml&#45;tag">&#60;z:textbox name=<span class="xml&#45;quote">"author"</span>/&#62;</span>
    <span class="xml&#45;tag">&#60;z:textbox name=<span class="xml&#45;quote">"title"</span>/&#62;</span>
    &#8230;
<span class="xml&#45;tag">&#60;/z:window&#62;</span></pre></div><p class="paragraph"/>Then in <code>your.Composer</code> use renderErrors<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">if</span> (!book.save()) &#123;
            formWindow.renderErrors(bean: book)
 &#125;</pre></div><p class="paragraph"/>
In addition,you can also use grails's traditional <code>renderErrors</code><p class="paragraph"/>In <code>your.Composer</code>
<div class="code"><pre><span class="java&#45;keyword">if</span> (!book.save()) &#123;
    flash.book = book
    redirect(controller: <span class="java&#45;quote">"book"</span>, action: <span class="java&#45;quote">"edit"</span>, id: book.id)
 &#125;</pre></div><p class="paragraph"/>In your view
<div class="code"><pre><span class="xml&#45;tag">&#60;g:hasErrors bean=<span class="xml&#45;quote">"$&#123;flash.book&#125;"</span>&#62;</span>
<span class="xml&#45;tag">&#60;div class=<span class="xml&#45;quote">"errors"</span>&#62;</span>
    <span class="xml&#45;tag">&#60;g:renderErrors bean=<span class="xml&#45;quote">"$&#123;flash.book&#125;"</span> as=<span class="xml&#45;quote">"list"</span> /&#62;</span>
<span class="xml&#45;tag">&#60;/div&#62;</span>
<span class="xml&#45;tag">&#60;/g:hasErrors&#62;</span></pre></div><p class="paragraph"/>
<h2><a name="3.8 ZK's Data Binding">3.8 ZK's Data Binding</a></h2>Data binding is a mechanism that automates the data-copy plumbing code (CRUD) between UI components and the data source. Application developers only have to tell the data binding manager about the associations between UI components and the data source. Then, the data -binding manager will do all the loading (loading data from the data source to UI components) and saving (saving data from UI component into the data source) jobs automatically.<p class="paragraph"/><h3>Activates Data Binding Manager</h3>
<div class="code"><pre><span class="xml&#45;tag">&#60;z:window  apply=<span class="xml&#45;quote">"org.zkoss.demo.MyComposer,org.zkoss.zkplus.databind.AnnotateDataBindingComposer"</span>&#62;</span>
<span class="xml&#45;tag">&#60;/z:window&#62;</span></pre></div><p class="paragraph"/>For more information, please refer to the relative blog post <a href="http://blog.zkoss.org/index.php/2011/08/11/databinding-composer/" target="blank">Databinding Composer</a><p class="paragraph"/><h3>Associate UI Components with Data Source</h3>
After activating the data-binding manager, you have to define the required UI objects and then associate them with the data source.<p class="paragraph"/>In the gsp view:
<div class="code"><pre><span class="xml&#45;tag">&#60;z:window id=<span class="xml&#45;quote">"win"</span> apply=<span class="xml&#45;quote">"test.TestComposer,org.zkoss.zkplus.databind.AnnotateDataBindingComposer"</span>&#62;</span>
    <span class="xml&#45;tag">&#60;z:textbox value=<span class="xml&#45;quote">"@&#123;win&#35;composer.username&#125;"</span>/&#62;</span>
<span class="xml&#45;tag">&#60;z:/window&#62;</span></pre></div><p class="paragraph"/>In the test.TestComposer:
<div class="code"><pre>class TestComposer&#123;<p class="paragraph"/>    def username=<span class="java&#45;quote">"test"</span><p class="paragraph"/>    def afterCompose = &#123;Component comp &#45;&#62;
        &#8230;
    &#125;
&#125;</pre></div><p class="paragraph"/>See more <a href="http://books.zkoss.org/wiki/ZK%20Developer's%20Reference/Data%20Binding" target="blank">ZK Developer&#39;s Reference/Data Binding</a><p class="paragraph"/>
<h1><a name="4. Builder">4. Builder</a></h1>Builders are internal DSLs that provide ease in working with certain types of problems.It is very useful for work with nested,hierarchical structures, such as tree structures, XML representations,or HTML representations.<p class="paragraph"/>Let’s take a look at an example of one way to create zk component in Groovy—using a builder:<p class="paragraph"/><h2><a name="4.1 appendChild">4.1 appendChild</a></h2><code>appendChild</code>  is dynamic method that  <em class="italic">ZKUI</em>  injection to zk <a href="http://www.zkoss.org/javadoc/latest/zk/org/zkoss/zk/ui/Component.html" target="blank">Component</a> to begin builder,which accepts a Closure parameter.
<div class="code"><pre>def window = <span class="java&#45;keyword">new</span> Window(title: <span class="java&#45;quote">"listbox demo"</span>, border: <span class="java&#45;quote">"normal"</span>)
window.appendChild &#123;
    listbox &#123;
        listhead(sizable: <span class="java&#45;keyword">true</span>) &#123;
            listheader(label: <span class="java&#45;quote">"name"</span>, sort: <span class="java&#45;quote">"auto"</span>)
            listheader(label: <span class="java&#45;quote">"gender"</span>, sort: <span class="java&#45;quote">"auto"</span>)
        &#125;
        listitem &#123;
            listcell(label: <span class="java&#45;quote">"Mary"</span>)
            listcell(label: <span class="java&#45;quote">"FEMALE"</span>)
        &#125;
        listitem &#123;
            listcell(label: <span class="java&#45;quote">"John"</span>)
            listcell(label: <span class="java&#45;quote">"MALE"</span>)
        &#125;
        listitem &#123;
            listcell(label: <span class="java&#45;quote">"Jane"</span>)
            listcell(label: <span class="java&#45;quote">"FEMALE"</span>)
        &#125;
        listitem &#123;
            listcell(label: <span class="java&#45;quote">"Henry"</span>)
            listcell(label: <span class="java&#45;quote">"MALE"</span>)
        &#125;
        listfoot &#123;
            listfooter &#123;
                label(value: <span class="java&#45;quote">"This is footer1"</span>)
            &#125;
            listfooter &#123;
                label(value: <span class="java&#45;quote">"This is footer2"</span>)
            &#125;
        &#125;
    &#125;
&#125;</pre></div><h2><a name="4.2 leftShift">4.2 leftShift</a></h2> <em class="italic">ZKUI</em>  also provides a convenient method <code>leftShift</code>( &#60;&#60; ),so you can modify the above code like:
<div class="code"><pre>def window = <span class="java&#45;keyword">new</span> Window(title: <span class="java&#45;quote">"listbox demo"</span>, border: <span class="java&#45;quote">"normal"</span>)
window &#60;&#60; &#123;
    listbox &#123;
       &#8230;
    &#125;
&#125;</pre></div><h2><a name="4.3 Event listening">4.3 Event listening</a></h2>If the parameter on onEvent it's a Closure, then it's a server side event
<div class="code"><pre>window &#60;&#60; &#123;
    button(label: 'button', onClick: &#123;
        Messagebox.show(<span class="java&#45;quote">"hello word! from Server"</span>)
    &#125;)
&#125;</pre></div><h2><a name="4.4 Client-side event listening">4.4 Client-side event listening</a></h2>If the parameter on onEvent it's a String, that is a client side event
<div class="code"><pre>window &#60;&#60; &#123;
    button(label: 'buutton', onClick: <span class="java&#45;quote">"alert('Say hello word! from JS')"</span>)
&#125;</pre></div><p class="paragraph"/>Add a prefix <code>client_</code> is useful when you also use server side event that avoid naming conflicts<p class="paragraph"/><div class="code"><pre>window &#60;&#60; &#123;
    button(label: 'buutton', client_onClick: <span class="java&#45;quote">"alert('Say hello word! from JS')"</span>,onClick:&#123;
        Messagebox.show(<span class="java&#45;quote">"hello word! from Server"</span>)
    &#125;)
&#125;</pre></div><h1><a name="5. Selector">5. Selector</a></h1><h2><a name="5.1 Selector overview">5.1 Selector overview</a></h2>ZK UI Plugin support a CSS (or jquery) like selector syntax to find matching components, that allows very powerful and robust queries.<p class="paragraph"/>It's inspired by the <a href="http://jsoup.org" target="blank">jsoup</a><p class="paragraph"/>The <code>select</code> method is injected to <a href="http://www.zkoss.org/javadoc/latest/zk/org/zkoss/zk/ui/Component.html" target="blank">Component</a>,which returns a list of Component.<p class="paragraph"/>View code
<div class="code"><pre><span class="xml&#45;tag">&#60;z:window id=<span class="xml&#45;quote">"window"</span> apply=<span class="xml&#45;quote">"MyComposer"</span>&#62;</span>
    <span class="xml&#45;tag">&#60;z:textbox name=<span class="xml&#45;quote">"t1"</span> value=<span class="xml&#45;quote">"value1"</span>/&#62;</span>
    <span class="xml&#45;tag">&#60;z:textbox id=<span class="xml&#45;quote">"t2"</span> value=<span class="xml&#45;quote">"value2"</span>/&#62;</span>
    <span class="xml&#45;tag">&#60;z:textbox value=<span class="xml&#45;quote">"value3"</span>/&#62;</span>
<span class="xml&#45;tag">&#60;/z:window&#62;</span></pre></div><p class="paragraph"/>Composer code
<div class="code"><pre>class MyComposer&#123;<p class="paragraph"/>    def afterCompose = &#123;Component window &#45;&#62;
        assert 3 == window.select(<span class="java&#45;quote">"textbox"</span>).size() // select method returns List&#60;Component&#62;
        assert <span class="java&#45;quote">"value2"</span> == window.select(<span class="java&#45;quote">"&#35;t2"</span>)&#91;0&#93;.value
        assert <span class="java&#45;quote">"value1"</span> == window.select(<span class="java&#45;quote">"textbox&#91;name=t1&#93;"</span>)&#91;0&#93;.value
    &#125;<p class="paragraph"/>&#125;</pre></div>
<h2><a name="5.2 Base Selector">5.2 Base Selector</a></h2><ul class="star">
<li><strong class="bold">tagname</strong>: find components by tag, e.g. <code>textbox</code></li>
<li><strong class="bold">#id</strong>: find components by ID, e.g. <code>#compId</code></li>
<li><strong class="bold">.class</strong>: find components by class name, e.g. <code>.masthead</code></li>
<li><strong class="bold">&#91;attribute]</strong>: components with attribute, e.g. <code>&#91;href]</code></li>
<li><strong class="bold">&#91;^attr]</strong>: components with an attribute name prefix, e.g. <code>&#91;^lab]</code></li>
<li><strong class="bold">&#91;attr=value]</strong>: components with attribute value, e.g. <code>&#91;width=500]</code></li>
<li><strong class="bold">&#91;attr^=value], &#91;attr$=value], &#91;attr&#42;=value]</strong>: components with attributes that start with, end with, or contain the value, e.g. <code>&#91;href*=/path/]</code></li>
<li><strong class="bold">&#91;attr~=regex]</strong>: components with attribute values that match the regular expression; e.g. <code>img&#91;src~=(?i)&#46;(png|jpe?g)]</code></li>
<li><strong class="bold">&#42;</strong>: all components, e.g. <code>&#42;</code></li>
</ul><p class="paragraph"/><h2><a name="5.3 Selector combinations">5.3 Selector combinations</a></h2><ul class="star">
<li><strong class="bold">el#id</strong>: components with ID, e.g. <code>textbox#compId</code></li>
<li><strong class="bold">el.class</strong>: components with class, e.g. <code>textbox.masthead</code></li>
<li><strong class="bold">el&#91;attr]</strong>: components with attribute, e.g. <code>a&#91;href]</code></li>
<li><strong class="bold">Any combination</strong>, e.g. <code>a&#91;href].highlight</code></li>
<li><strong class="bold">ancestor child</strong>: child components that descend from ancestor, e.g. <code>.body textbox</code> finds <code>textbox</code> components anywhere under a block with class "body"</li>
<li><strong class="bold">parent &#62; child</strong>: child components that descend directly from parent, e.g. <code>window.content &#62; textbox</code> finds textbox components; and <code>window &#62; *</code> finds the direct children of the window tag</li>
<li><strong class="bold">siblingA + siblingB</strong>: finds sibling B element immediately preceded by sibling A, e.g. <code></code>div.head + div<code></code></li>
<li><strong class="bold">siblingA ~ siblingX</strong>: finds sibling X element preceded by sibling A, e.g. <code>intbox ~ textbox</code></li>
<li><strong class="bold">el, el, el</strong>: group multiple selectors, find unique components that match any of the selectors; e.g. <code>div.masthead, div.logo</code></li>
</ul><p class="paragraph"/><h2><a name="5.4 Pseudo selectors">5.4 Pseudo selectors</a></h2><ul class="star">
<li><strong class="bold">:lt(n)</strong>: find components whose sibling index (i.e. its position in the component tree relative to its parent) is less than n; e.g. <code>listitem:lt(3)</code></li>
<li><strong class="bold">:gt(n)</strong>: find components whose sibling index is greater than n; e.g. <code>div label:gt(2)</code></li>
<li><strong class="bold">:eq(n)</strong>: find components whose sibling index is equal to n; e.g. <code>window textbox:eq(1)</code></li>
<li><strong class="bold">:has(seletor)</strong>: find components that contain components matching the selector; e.g. <code>div:has(label)</code></li>
<li><strong class="bold">:not(selector)</strong>: find components that do not match the selector; e.g. <code>div:not(.logo)</code></li>
</ul><p class="paragraph"/><h1><a name="6. Event Handling">6. Event Handling</a></h1><h2><a name="6.1 Event Listening">6.1 Event Listening</a></h2><h3>Declare an Event Handler in gsp</h3><p class="paragraph"/>An event handler can be declared in a gsp page by specifying an event attribute(An event attribute is an attribute starting with on). For example,
<div class="code"><pre><span class="xml&#45;tag">&#60;z:button label=<span class="xml&#45;quote">"hi"</span> onClick='alert(<span class="xml&#45;quote">"Hello"</span>)'/&#62;</span></pre></div>
where the content of the event handler is the code snippet in Groovy. The event handler will be interpreted at the run time.<p class="paragraph"/>Important Builtin Variables
<ul class="star">
<li>self - the component receiving the event. In the previous example, it is the button itself.</li>
<li>event - the event being received. In the previous example, it is an instance of MouseEvent.</li>
</ul><p class="paragraph"/><h3>Listen by Use of an Event Listener</h3><p class="paragraph"/>An event listener is a class implementing EventListener. For example,
<div class="code"><pre>class MyListener <span class="java&#45;keyword">implements</span> EventListener &#123;
    void onEvent(Event event) &#123;
        Messages.show(<span class="java&#45;quote">"Hello"</span>)
    &#125;
&#125;</pre></div><p class="paragraph"/>Then, you can register an event listener to the component that might receive the event by use of Component.addEventListener(String, EventListener). For example,
<div class="code"><pre>button.addEventListener(<span class="java&#45;quote">"onClick"</span>, <span class="java&#45;keyword">new</span> MyListener())</pre></div><p class="paragraph"/>This is a typical approach to handle events. However, it is a bit tedious to register event listeners one-by-one if there are a lot of listeners.
 Rather, it is suggested to use the following method:<p class="paragraph"/><div class="code"><pre>button.addEventListener(<span class="java&#45;quote">"onClick"</span>)&#123;Event event&#45;&#62;
    Messages.show(<span class="java&#45;quote">"Hello"</span>)
&#125;</pre></div><p class="paragraph"/>
<h3>Composer and Event Listener Autowiring</h3><p class="paragraph"/>With <a href="../guide/single.html#3.3 Auto-wired Component" class="guide">Auto-wired Component</a>, you generally don't need to register event listeners manually. Rather, they could be registered automatically by use of the auto-wiring feature of a composer. For example<p class="paragraph"/><div class="code"><pre>class MyComposer&#123;
    void onClick_hi() &#123;
        Messsagebox.show(<span class="java&#45;quote">"Hello"</span>)
    &#125;
    void onClick_bye() &#123;
        Messsagebox.show(<span class="java&#45;quote">"Bye"</span>)
    &#125;
&#125;</pre></div><p class="paragraph"/>As shown above, the method to listen an event shall be named by starting with the event name, separating with <code>_</code>, and ending with the component's ID. The composer will search all matched methods and register the event listener automatically. Then, in the gsp page, you can specify the apply attribute to associate the composer with a component.
<div class="code"><pre><span class="xml&#45;tag">&#60;z:window apply=<span class="xml&#45;quote">"MyComposer"</span>&#62;</span>
    <span class="xml&#45;tag">&#60;z:textbox/&#62;</span>
    <span class="xml&#45;tag">&#60;z:button id=<span class="xml&#45;quote">"hi"</span>/&#62;</span>
    <span class="xml&#45;tag">&#60;z:button id=<span class="xml&#45;quote">"bye"</span>/&#62;</span>
<span class="xml&#45;tag">&#60;/z:window&#62;</span></pre></div><p class="paragraph"/>If the listener needs to access the event, just declare it as the argument:
<div class="code"><pre>void onClick_hi(MouseEvent event) &#123;
  Messsagebox.show(<span class="java&#45;quote">"Hello, "</span> + event.getName())
&#125;</pre></div>
Though not limited, a composer is usually associated with an ID space (such as Window) to handle events and component within the give ID space. You could associate any component that properly represents a scope of your application to manage.
See more <a href="../guide/single.html#3.3 Auto-wired Component" class="guide">Auto-wired Component</a><p class="paragraph"/><h4>Declare a Event Handler in zkui's Builder</h4><p class="paragraph"/>see <a href="../guide/single.html#4.3 Event listening" class="guide">Event listening</a><h2><a name="6.2 Client-side Event Listening">6.2 Client-side Event Listening</a></h2>ZK allows applications to handle events at both the server and client side. Handling events at the server side, as described in the previous sections, are more common, since the listeners can access the backend services directly. However, handling event at the client side improves the responsiveness. For example, it is better to be done with a client-side listener if you want to open the drop-down list when a comobox gains focus.
A good rule of thumb is to use server-side listeners first since it is easier, and then improve the responsiveness of the critical part, if any, with the client-side listener.<p class="paragraph"/><h3>Declare a Client-side Listener in gsp</h3>
Declaring a client-side listener in a gsp  is similar to declaring a server-side listener, except
<ul class="star">
<li>Use the client_  Prefix</li>
<li>It is JavaScript</li>
<li>Use this to reference to the target widget (while the event is referenced with event)</li>
<li>Use this.$f() to reference fellow widgets (Widget.$f())</li>
</ul><p class="paragraph"/>For example,
<div class="code"><pre><span class="xml&#45;tag">&#60;z:combobox client_onFocus=<span class="xml&#45;quote">"this.open()"</span>/&#62;</span></pre></div><p class="paragraph"/><h3>The Relationship between Client and Server-side Event Listener</h3>
It is allowed to register both the client and server-side event listeners. They will be both invoked. Of course, the client-side listener is called first, and then the server-side listener. For example,
<div class="code"><pre><span class="xml&#45;tag">&#60;z:div&#62;</span>
  <span class="xml&#45;tag">&#60;z:combobox client_onFocus=<span class="xml&#45;quote">"this.open()"</span> onFocus=<span class="xml&#45;quote">"self.parent.appendChild(new Label('focus'))"</span>/&#62;</span>
<span class="xml&#45;tag">&#60;/z:div&#62;</span></pre></div>
If you want to stop the event propagation such that the server won't receive the event, you could invoke Event.stop(Map). For example, the server-side listener won't be invoked in the following example:
<div class="code"><pre><span class="xml&#45;tag">&#60;z:div&#62;</span>
  <span class="xml&#45;tag">&#60;z:combobox client_onFocus=<span class="xml&#45;quote">"this.open(); event.stop();"</span> onFocus=<span class="xml&#45;quote">"self.parent.appendChild(new Label('focus'))"</span>/&#62;</span>
<span class="xml&#45;tag">&#60;/z:div&#62;</span></pre></div><p class="paragraph"/>
<h3>Declare a Client-side Listener in Groovy</h3>
The other way to declare a client-side listener at the server is Component.setWidgetListener(String, String). For example,
<div class="code"><pre>combobox.setWidgetListener(<span class="java&#45;quote">"onFocus"</span>, <span class="java&#45;quote">"<span class="java&#45;keyword">this</span>.open()"</span>)</pre></div>
Notice that it is Groovy and running at the server.<p class="paragraph"/><h4>Register a Client-side Listener in Client-Side JavaScript</h4>
Listening an event at the client could be done by calling Widget.listen(Map, int). For example,
<div class="code"><pre><span class="xml&#45;tag">&#60;z:window&#62;</span>
    <span class="xml&#45;tag">&#60;z:bandbox id=<span class="xml&#45;quote">"bb"</span>/&#62;</span>
    <span class="xml&#45;tag">&#60;z:script defer=<span class="xml&#45;quote">"true"</span>&#62;</span>
        this.$f().bb.listen(&#123;onFocus: function () &#123;this.open();&#125;&#125;);
    <span class="xml&#45;tag">&#60;/z:script&#62;</span>
<span class="xml&#45;tag">&#60;/z:window&#62;</span></pre></div>
where
<ul class="star">
<li>defer="true" is required such that the JavaScript code will be evaluated after all widgets are created successfully. Otherwise, it is not able to retreive the bandbox (bb).</li>
<li>script is a widget (unlike zscript), so this references to the script widget, rather than the parent.</li>
<li>Widget.$f(String) is equivalent to Component.getFellow(String), except it is a JavaScript method (accessible at the client).</li>
</ul><p class="paragraph"/><h4>Declare a Client-side Listener in zkui's Builder</h4><p class="paragraph"/>see <a href="../guide/single.html#4.4 Client-side event listening" class="guide">Client-side event listening</a><h1><a name="7. Scaffolding Templates">7. Scaffolding Templates</a></h1><code>Zkui</code> supports a feature known as scaffolding which involves the generation of a CRUD (Create/Read/Update/Delete) interface for a given domain class
<h2><a name="7.1 Static Scaffolding">7.1 Static Scaffolding</a></h2>Same as Grails's generate-all command,<code>zkui</code> use <a href="../ref/Command Line/zkui-generate-all.html" class="Command Line">zkui-generate-all</a> to generates views,composer and a controller for the given domain class<p class="paragraph"/><blockquote class="note">
To zkui's scaffolding work,you need modify the default layout/main.gsp
<ol>
<li>Add the tag &#60;z:resources/&#62; to the head</li>
<li>Remove &#60;link rel="stylesheet" href="${resource(dir:'css',file:'main.css')}" /&#62;</li>
<li>Generate the doc type as follows</li>
</ol><p class="paragraph"/><div class="code"><pre>&#60;!DOCTYPE html PUBLIC <span class="xml&#45;quote">"&#45;//W3C//DTD XHTML 1.0 Transitional//EN"</span>
 <span class="xml&#45;quote">"http://www.w3.org/TR/xhtml1/DTD/xhtml1&#45;transitional.dtd"</span>&#62;</pre></div><p class="paragraph"/>
The complete layout/main.gsp Examples
<div class="code"><pre>&#60;!DOCTYPE html PUBLIC <span class="xml&#45;quote">"&#45;//W3C//DTD XHTML 1.0 Transitional//EN"</span>
 <span class="xml&#45;quote">"http://www.w3.org/TR/xhtml1/DTD/xhtml1&#45;transitional.dtd"</span>&#62;
<span class="xml&#45;tag">&#60;html xmlns=<span class="xml&#45;quote">"http://www.w3.org/1999/xhtml"</span>&#62;</span>
<span class="xml&#45;tag">&#60;head&#62;</span>
    <span class="xml&#45;tag">&#60;title&#62;</span><span class="xml&#45;tag">&#60;g:layoutTitle default=<span class="xml&#45;quote">"Grails"</span>/&#62;</span><span class="xml&#45;tag">&#60;/title&#62;</span>
    <span class="xml&#45;tag">&#60;z:resources/&#62;</span>
    <span class="xml&#45;tag">&#60;g:layoutHead/&#62;</span>
<span class="xml&#45;tag">&#60;/head&#62;</span>
<span class="xml&#45;tag">&#60;body&#62;</span>
<span class="xml&#45;tag">&#60;div id=<span class="xml&#45;quote">"grailsLogo"</span>&#62;</span><span class="xml&#45;tag">&#60;a href=<span class="xml&#45;quote">"http://grails.org"</span>&#62;</span><span class="xml&#45;tag">&#60;img src=<span class="xml&#45;quote">"$&#123;resource(dir: 'images', file: 'grails_logo.png')&#125;"</span>
                                                      alt=<span class="xml&#45;quote">"Grails"</span> border=<span class="xml&#45;quote">"0"</span>/&#62;</span><span class="xml&#45;tag">&#60;/a&#62;</span><span class="xml&#45;tag">&#60;/div&#62;</span>
<span class="xml&#45;tag">&#60;g:layoutBody/&#62;</span>
<span class="xml&#45;tag">&#60;/body&#62;</span>
<span class="xml&#45;tag">&#60;/html&#62;</span></pre></div><p class="paragraph"/></blockquote><h2><a name="7.2 Customizing the scaffolding templates">7.2 Customizing the scaffolding templates</a></h2>The templates used by zkui to generate the controller, views and composer can be customized by installing the templates with the <code>zkui-install-templates</code> command.
<h1><a name="8. Integration">8. Integration</a></h1><h2><a name="8.1 ZK EE">8.1 ZK EE</a></h2>ZK UI supports  ZK Enterprise features.<p class="paragraph"/>Just put the zk ee jar to <code>libs</code> or put jar dependencies in grails-app/conf/BuildConfig.groovy<p class="paragraph"/>You can also install the Enterprise edition by
<div class="code"><pre>$ grails install&#45;plugin zk&#45;ee</pre></div><p class="paragraph"/>This plugin contains addition jars required for enabling ZK Enterprise features.<h2><a name="8.2 ZK Themes">8.2 ZK Themes</a></h2><h3>How to use</h3><p class="paragraph"/>You can simply put theme jar in <code>lib</code> directory.<p class="paragraph"/>Or add dependencies in grails-app/conf/BuildConfig.groovy
<h4>First, add zkoss' maven Dependency Repositories</h4>
<div class="code"><pre>repositories &#123;
        &#8230;
        mavenRepo <span class="java&#45;quote">"http://mavensync.zkoss.org/maven2/"</span>
        &#8230;
&#125;</pre></div>
<h4>Second,specify dependencies</h4>
<div class="code"><pre>dependencies &#123;
        // there are three theme 'breeze', 'sapphire', 'silvertail'
        def zkThemeVersion=<span class="java&#45;quote">"5.0.9"</span>
        def zkTheme=<span class="java&#45;quote">"breeze"</span>
        runtime <span class="java&#45;quote">"org.zkoss.theme:$&#123;zkTheme&#125;:$&#123;zkThemeVersion&#125;"</span>
    &#125;</pre></div><p class="paragraph"/>
<h3>How to switch different themes dynamically</h3><p class="paragraph"/>The default theme provider checks the current theme settings in order of preferences;<p class="paragraph"/><h4>First priority: Cookie</h4>
Set cookie zktheme=name<p class="paragraph"/>For instance, write cookie zktheme=breeze, breeze theme will be activated<p class="paragraph"/><h4>Second priority: Library property</h4>
The default theme provider will obtain the current theme setting from library property if cookie is empty.
<div class="code"><pre><span class="xml&#45;tag">&#60;library&#45;property&#62;</span>
     <span class="xml&#45;tag">&#60;name&#62;</span>org.zkoss.theme.preferred<span class="xml&#45;tag">&#60;/name&#62;</span>
     <span class="xml&#45;tag">&#60;value&#62;</span>name<span class="xml&#45;tag">&#60;/value&#62;</span>
<span class="xml&#45;tag">&#60;/library&#45;property&#62;</span></pre></div>
For example, the following code will activiate the breeze theme.
<div class="code"><pre><span class="xml&#45;tag">&#60;library&#45;property&#62;</span>
     <span class="xml&#45;tag">&#60;name&#62;</span>org.zkoss.theme.preferred<span class="xml&#45;tag">&#60;/name&#62;</span>
     <span class="xml&#45;tag">&#60;value&#62;</span>breeze<span class="xml&#45;tag">&#60;/value&#62;</span>
<span class="xml&#45;tag">&#60;/library&#45;property&#62;</span></pre></div><p class="paragraph"/><h4>Third priority: System's default them</h4>
The default theme provider maintains a default theme. If theme provider can't find theme setting in cookie or library property, default theme will be activated.<p class="paragraph"/>
<h3>Dynamically switch themes using cookie</h3><p class="paragraph"/>Here are a list of cookie sample codes that you can choose from.
<h4>Breeze</h4>
<div class="code"><pre>Themes.setTheme(Executions.getCurrent(), <span class="java&#45;quote">"breeze"</span>)
Executions.sendRedirect(<span class="java&#45;keyword">null</span>)</pre></div><p class="paragraph"/><h4>Sapphire</h4>
<div class="code"><pre>Themes.setTheme(Executions.getCurrent(), <span class="java&#45;quote">"sapphire"</span>)
Executions.sendRedirect(<span class="java&#45;keyword">null</span>)</pre></div><p class="paragraph"/><h4>Silvertail</h4>
<div class="code"><pre>Themes.setTheme(Executions.getCurrent(), <span class="java&#45;quote">"silvertail"</span>)
Executions.sendRedirect(<span class="java&#45;keyword">null</span>)</pre></div><p class="paragraph"/><h4>Classic blue</h4>
<div class="code"><pre>Themes.setTheme(Executions.getCurrent(), <span class="java&#45;quote">"classicblue"</span>)
Executions.sendRedirect(<span class="java&#45;keyword">null</span>)</pre></div><p class="paragraph"/><h3>Dynamically switch themes using library property</h3><p class="paragraph"/><h4>Breeze</h4>
<div class="code"><pre>Library.setProperty(<span class="java&#45;quote">"org.zkoss.theme.preferred"</span>, <span class="java&#45;quote">"breeze"</span>)
Executions.sendRedirect(<span class="java&#45;keyword">null</span>)</pre></div><p class="paragraph"/><h4>Sapphire</h4>
<div class="code"><pre>Library.setProperty(<span class="java&#45;quote">"org.zkoss.theme.preferred"</span>, <span class="java&#45;quote">"sapphire"</span>)
Executions.sendRedirect(<span class="java&#45;keyword">null</span>)</pre></div><p class="paragraph"/><h4>Silvertail</h4>
<div class="code"><pre>Library.setProperty(<span class="java&#45;quote">"org.zkoss.theme.preferred"</span>, <span class="java&#45;quote">"silvertail"</span>)
Executions.sendRedirect(<span class="java&#45;keyword">null</span>)</pre></div><p class="paragraph"/><h4>Classic blue</h4>
<div class="code"><pre>Library.setProperty(<span class="java&#45;quote">"org.zkoss.theme.preferred"</span>, <span class="java&#45;quote">"classicblue"</span>)
Executions.sendRedirect(<span class="java&#45;keyword">null</span>)</pre></div><p class="paragraph"/><h3>Retrieve web app supported theme names</h3>
<div class="code"><pre><span class="java&#45;object">String</span> names = Library.getProperty(<span class="java&#45;quote">"org.zkoss.theme.names"</span>);</pre></div><p class="paragraph"/><h3>Reference</h3>
<a href="http://code.google.com/p/zkthemes/wiki/GetStarted" target="blank">ZK Themes GetStarted</a><h2><a name="8.3 ZK Extensions Component">8.3 ZK Extensions Component</a></h2>You can extends the org.grails.plugins.zkui.AbstractTagLib implement the Extensions Component's Taglib same as:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">import</span> org.grails.plugins.zkui.AbstractTagLib<p class="paragraph"/>class CalendarsTagLib <span class="java&#45;keyword">extends</span> AbstractTagLib &#123;
    <span class="java&#45;keyword">static</span> namespace = <span class="java&#45;quote">"z"</span><p class="paragraph"/>    def calendars = &#123; attrs, body &#45;&#62;
        doTag(attrs, body, <span class="java&#45;quote">"calendars"</span>)
    &#125;<p class="paragraph"/>&#125;</pre></div><p class="paragraph"/>
and put the Calendar jar to <code>lib</code>
        </div>
        <div id="footer">
             Grails ZK UI Plugin Project
        </div>
    </body>
</html>
