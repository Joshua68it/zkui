<html>
    <head>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
        <title>3.9 The Next Generation Data Binding System</title>
        <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" title="Ref" charset="utf-8"/>
    </head>
    <body class="body">
    <h3>Introduction</h3>
ZK Bind is a whole new data binding system with new specifications and implementations.<p class="paragraph"/><h3>Features</h3><p class="paragraph"/><h4>A whole new, clean annotation expression</h4>
<ul class="star">
<li>Same Java style annotation expression: The new ZK annotation is consistent with Java's annotation style. If you know the Java style, you know the ZK Style.</li>
<li>A set of collaborated annotations: ZK Bind uses a set of annotations to make the use of data binding as intuitive and clear as possible.</li>
<ul class="star">
<li>@bind(...): used to bind data and command along with parameters</li>
<li>@converter(...): used to specify converters along with parameters</li>
<li>@valiator(...): used to specify validators along with parameters</li>
<li>@form(...): used to bind a form.</li>
</ul></ul><p class="paragraph"/><h4>EL 2.2 flexiable expressions</h4>
<ul class="star">
<li>ZK Bind accept EL 2.2 syntax expression that you can provide flexible operations easily.</li>
<li>Bind to bean properties, indexed properties, Map keys seamlessly.</li>
<li>Bind to component custom attributes automatically.</li>
<li>Bind to Spring, CDI, and Seam managed bean automatically.</li>
</ul><p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;z:image src=<span class="xml&#45;quote">"<code>bind(vm.person.boy ? 'boy.png' : 'girl.png')"</span>/&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;z:button onClick=<span class="xml&#45;quote">"</code>bind(vm.add ? 'add' : 'update')"</span> label=<span class="xml&#45;quote">"<code>bind(vm.add ? 'Add' : 'Update'"</span>/&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;z:button onClick=<span class="xml&#45;quote">"</code>bind('subscribe')"</span> disabled=<span class="xml&#45;quote">"@bind(empty vm.symbol)"</span> label=<span class="xml&#45;quote">"Subscribe"</span>/&#62;</span></pre></div><p class="paragraph"/><h4>One way load only data binding</h4>
<ul class="star">
<li>Load when bean property changes</li>
<li>Conditional load <code>after</code>/<code>before</code> executing a command</li>
<li>Multiple conditional load <code>before</code>/<code>after</code> executing different/same commands</li>
</ul><p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;z:label value=<span class="xml&#45;quote">"<code>bind(load=vm.person.fullname)"</span>/&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;z:label value=<span class="xml&#45;quote">"</code>bind(load=vm.person.firstname after 'update')"</span>/&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;z:label value=<span class="xml&#45;quote">"<code>bind(load=vm.person.firstname before 'delete')"</span>/&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;z:label value=<span class="xml&#45;quote">"</code>bind(load=&#123;vm.person.firstname after 'update', vm.person.message after 'delete'&#125;)"</span>/&#62;</span></pre></div><p class="paragraph"/><h4>One way save only data binding</h4>
<ul class="star">
<li>Save when UI component attribute changes</li>
<li>Multiple save to property of different target beans</li>
<li>Conditional save before/after executing a command</li>
<li>Multiple conditional save before/after executing different/same commands</li>
</ul><p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;z:textbox value=<span class="xml&#45;quote">"<code>bind(save=vm.person.firstname)"</span>/&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;z:textbox value=<span class="xml&#45;quote">"</code>bind(save=&#123;vm.person.firstname, vm.tmpperson.firstname&#125;)"</span>/&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;z:textbox value=<span class="xml&#45;quote">"<code>bind(save=vm.person.firstname before 'update')"</span>/&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;z:textbox value=<span class="xml&#45;quote">"</code>bind(save=vm.person.firstname after 'delete'"</span>/&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;z:textbox value=<span class="xml&#45;quote">"@bind(save=&#123;vm.selected.firstname before 'update', vm.newperson.firstname before 'add'&#125;"</span>/&#62;</span></pre></div><p class="paragraph"/><h4>Initial data binding</h4>
<ul class="star">
<li>Load when UI components are first added into the binding system</li>
</ul><p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;z:label value=<span class="xml&#45;quote">"@bind(init=vm.selected.firstname)"</span>/&#62;</span></pre></div><p class="paragraph"/><h4>Two way data binding</h4>
<ul class="star">
<li>Short expression of both save and load bindings</li>
<li>Multiple conditional load and save on different back-end beans before/after executing different/same commands</li>
</ul><p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;z:textbox value=<span class="xml&#45;quote">"<code>bind(vm.person.firstname)"</span>/&#62;</span><p class="paragraph"/><span class="xml&#45;tag">&#60;z:textbox value=<span class="xml&#45;quote">"</code>bind(load=vm.selected.firstname, save=&#123;vm.selected.firstname, vm.newperson.firstname before 'add'&#125;)"</span>/&#62;</span></pre></div><p class="paragraph"/><h4>Bind to any attributes of the UI components</h4>
<ul class="star">
<li>Bind symmetrically to all attributes of UI components</li>
</ul><p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;z:textbox value=<span class="xml&#45;quote">"@bind(vm.symbol)"</span> instant=<span class="xml&#45;quote">"true"</span>/&#62;</span>
<span class="xml&#45;tag">&#60;z:button onClick=<span class="xml&#45;quote">"<code>bind('subscribe')"</span> disabled=<span class="xml&#45;quote">"</code>bind(empty vm.symbol)"</span> label=<span class="xml&#45;quote">"Subscribe"</span> /&#62;</span></pre></div><p class="paragraph"/><h4>Event command binding</h4>
<ul class="star">
<li>Bridge ZK event to command</li>
<li>Automatic event listener registration</li>
<li>Simple command name invocation</li>
</ul><p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;z:button onClick=<span class="xml&#45;quote">"<code>bind('subscribe')"</span> disabled=<span class="xml&#45;quote">"</code>bind(empty vm.symbol)"</span> label=<span class="xml&#45;quote">"Subscribe"</span> /&#62;</span></pre></div><p class="paragraph"/><h4>Template/Collection binding</h4>
<ul class="star">
<li>Binding on Listbox/Grid/Tree/Combobox</li>
<li>Local variable scope is limited to the container component</li>
<li>Support index property</li>
</ul><p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;z:listbox width=<span class="xml&#45;quote">"300px"</span> model=<span class="xml&#45;quote">"<code>bind(vm.albumList)"</span> selectedItem=<span class="xml&#45;quote">"</code>bind(vm.selectedAlbum)"</span> vflex=<span class="xml&#45;quote">"true"</span>&#62;</span>
    <span class="xml&#45;tag">&#60;z:template name=<span class="xml&#45;quote">"model"</span> var=<span class="xml&#45;quote">"a"</span>&#62;</span>
        <span class="xml&#45;tag">&#60;listitem label=<span class="xml&#45;quote">"@bind(a.title)"</span>/&#62;</span>
    <span class="xml&#45;tag">&#60;/z:template&#62;</span>
<span class="xml&#45;tag">&#60;/z:listbox&#62;</span></pre></div><p class="paragraph"/><h4>Form binding</h4>
<ul class="star">
<li>Middle form binding to avoid affecting back-end data beans</li>
<li>Submit a form in a whole</li>
<li>Conditional save for different commands</li>
</ul><p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;z:grid self=<span class="xml&#45;quote">"@form(id='fx', load=vm.selected, save=&#123;vm.selected before 'update', vm.newAlbum before 'add'&#125;)"</span>&#62;</span>
    <span class="xml&#45;tag">&#60;z:row&#62;</span>Title: <span class="xml&#45;tag">&#60;z:textbox value=<span class="xml&#45;quote">"@bind(fx.title)"</span>/&#62;</span><span class="xml&#45;tag">&#60;/z:row&#62;</span>
    <span class="xml&#45;tag">&#60;z:row&#62;</span>Artist: <span class="xml&#45;tag">&#60;z:textbox value=<span class="xml&#45;quote">"@bind(fx.artist)"</span>/&#62;</span><span class="xml&#45;tag">&#60;/z:row&#62;</span>
    <span class="xml&#45;tag">&#60;z:row&#62;</span><span class="xml&#45;tag">&#60;z:checkbox checked=<span class="xml&#45;quote">"@bind(fx.classical)"</span>/&#62;</span> Classical<span class="xml&#45;tag">&#60;/z:row&#62;</span>
    <span class="xml&#45;tag">&#60;z:row&#62;</span>Composer: <span class="xml&#45;tag">&#60;z:textbox value=<span class="xml&#45;quote">"@bind(fx.composer)"</span>/&#62;</span><span class="xml&#45;tag">&#60;/z:row&#62;</span>
<span class="xml&#45;tag">&#60;/z:grid&#62;</span>
<span class="xml&#45;tag">&#60;z:button onClick=<span class="xml&#45;quote">"@bind('add')"</span> label=<span class="xml&#45;quote">"Add"</span>/&#62;</span>
<span class="xml&#45;tag">&#60;z:button onClick=<span class="xml&#45;quote">"@bind('update')"</span> label=<span class="xml&#45;quote">"Update"</span>/&#62;</span></pre></div><p class="paragraph"/><h4>Java annotated data dependency tracking</h4>
<ul class="star">
<li>Controllable load on save</li>
<li>@NotifyChange to notify property changes</li>
<li>@DependsOn to specify property change dependency</li>
</ul><p class="paragraph"/><div class="code"><pre>@NotifyChange //notify firstname change
<span class="java&#45;keyword">public</span> void setFirstname(<span class="java&#45;object">String</span> fn) &#123;
    firstname = fn;
&#125;<p class="paragraph"/>@NotifyChange //notify lastname change
<span class="java&#45;keyword">public</span> void setLastname(<span class="java&#45;object">String</span> ln) &#123;
    lastname = ln;
&#125;<p class="paragraph"/>@DependsOn(&#123;<span class="java&#45;quote">"firstname"</span>,<span class="java&#45;quote">"lastname"</span>&#125;) //full name will change <span class="java&#45;keyword">if</span> either firstname and/or lastname change
<span class="java&#45;keyword">public</span> <span class="java&#45;object">String</span> getFullname() &#123;
    <span class="java&#45;keyword">return</span> firstname + <span class="java&#45;quote">" "</span> + lastname;
&#125;</pre></div><p class="paragraph"/><h4>Embedded validation cycle</h4>
<ul class="star">
<li>Bind validator by name or by EL expression</li>
<li>Embedded system Validator: provide commonly used validators that user can use directly by specifying only the name</li>
<li>Validate a single property or a form</li>
<li>Validate on a command</li>
</ul><p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;z:textbox value=<span class="xml&#45;quote">"<code>bind(save=vm.selected.firstname) </code>validator('noEmpty')"</span>/&#62;</span>
<span class="xml&#45;tag">&#60;z:grid self=<span class="xml&#45;quote">"<code>form(id='fx', load=vm.selected, save=vm.selected before 'update') </code>validator(vm.passwordValidator)"</span>&#62;</span>
    <span class="xml&#45;tag">&#60;z:row&#62;</span>username<span class="xml&#45;tag">&#60;textbox value=<span class="xml&#45;quote">"@bind(fx.username)"</span>/&#62;</span><span class="xml&#45;tag">&#60;/z:row&#62;</span>
    <span class="xml&#45;tag">&#60;z:row&#62;</span>password<span class="xml&#45;tag">&#60;textbox value=<span class="xml&#45;quote">"@bind(fx.password)"</span> type=<span class="xml&#45;quote">"password"</span>/&#62;</span><span class="xml&#45;tag">&#60;/z:row&#62;</span>
    <span class="xml&#45;tag">&#60;z:row&#62;</span>retype password<span class="xml&#45;tag">&#60;textbox value=<span class="xml&#45;quote">"@bind(fx.retypePassword)"</span> type=<span class="xml&#45;quote">"password"</span>/&#62;</span><span class="xml&#45;tag">&#60;/z:row&#62;</span>
<span class="xml&#45;tag">&#60;/z:grid&#62;</span></pre></div><p class="paragraph"/><h4>Enhanced converter mechanism</h4>
<ul class="star">
<li>Bind converter by name or by EL expression</li>
<li>Embedded system Converters: provide commonly used converters that user can use directly by specifying only the name</li>
</ul><p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;z:datebox value=<span class="xml&#45;quote">"<code>bind(vm.selected.birthday) </code>converter('formatedDate', format='yyyy/MM/dd')"</span>/&#62;</span></pre></div><p class="paragraph"/><h4>org.zkoss.bind.BindComposer</h4>
<ul class="star">
<li>Ease UI components, binder, and ViewModel association</li>
<li>Each binder covers only the applied component tree</li>
<li>Inter-binder communications</li>
</ul><p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;z:window apply=<span class="xml&#45;quote">"org.zkoss.bind.BindComposer"</span> viewModel=<span class="xml&#45;quote">"@bind(vm='org.zkoss.mvvm.examples.album.AlbumViewModel')"</span>&#62;</span>
    &#8230;
<span class="xml&#45;tag">&#60;/z:window&#62;</span></pre></div><p class="paragraph"/><h4>Bind on demand</h4>
<ul class="star">
<li>Support dynamically add/remove bindings by API.</li>
<li>Attached components with binding annotations are automatically managed by the existing binder if covered.</li>
<li>Detached components that were managed by a binder are automatically removed from the binding management.</li>
</ul><p class="paragraph"/><h4>Support seamless MVVM design pattern</h4>
<ul class="star">
<li>Utilize MVVM design pattern to achieve separation of data and logic from presentation easily.</li>
<ul class="star">
<li>UI Design and ViewModel can be implemented in parallel independently.</li>
<li>Can add new Views or change current View easily.</li>
<li>Different views for different devices with a common ViewModel.</li>
<li>Allow unit-test ViewModel independently without UI environments.</li>
</ul></ul><p class="paragraph"/><h4>For details</h4><p class="paragraph"/><a href="http://books.zkoss.org/wiki/Small_Talks/2011/October/Envisage_ZK_6:_The_Next_Generation_Data_Binding_System" target="blank">Envisage ZK 6: The Next Generation Data Binding System</a><p class="paragraph"/><p class="paragraph"/><p class="paragraph"/><p class="paragraph"/><p class="paragraph"/>
    </body>
</html>
